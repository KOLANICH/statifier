#!/bin/sh

# Copyright (C) 2004 Valery Reznic
# This file is part of the Elf Statifier project
# 
# This project is free software; you can redistribute it and/or
# modify it under the terms of the GNU General Public License.
# See LICENSE file in the doc directory.

PROCESSOR=`uname -m` || exit
# Compatability translation (stollen from rpm macros)
COMPAT_PROCESSOR="$PROCESSOR"
case "$PROCESSOR" in
	i386 | i486 | i586 | i686 | athlon) COMPAT_PROCESSOR=i386;;
	amd)                                COMPAT_PROCESSOR=x86_64;;
esac || exit

Output=config
Input=$Output.$COMPAT_PROCESSOR
[ -f $Input ] || {
	echo "$0: processor '$PROCESSOR' not supported." 1>&2
	exit 1
}

rm -f $Output || exit
(
	echo "# Don't change this file. It generated by $0 from $Input" &&
	echo                                                            &&
	echo "PROCESSOR        := $PROCESSOR"                           &&
	echo "COMPAT_PROCESSOR := $COMPAT_PROCESSOR"                    &&
	echo                                                            &&
	cat config.$COMPAT_PROCESSOR                                    &&
	:
) > $Output || { rm -f $Output; exit 1; }
exit 0
